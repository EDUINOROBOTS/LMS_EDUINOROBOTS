<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 6 LMS</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="grade6">
    <button id="openIntro" class="intro-btn">INTRODUCTION</button>
         <div class="dashboard">
            <h1>ðŸŒ² GRADE 6 Learning Management System</h1>
            <div class="welcome">Welcome to Grade 6</div>
            <div class="curriculum">
                    <div class="button-grid" id="buttonGrid">
                    <!-- Buttons will be generated by JS -->
                </div>
            </div>
        </div>
    </div>


    <script>
        const INTRO_URL = 'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing';
        document.getElementById('openIntro')?.addEventListener('click', () => {
            window.open(INTRO_URL, '_blank', 'noopener');
        });

        const tasks = [
            "IR Sensor-based Line Follower",
            "Obstacle Avoidance Bot",
            "Ultrasonic Distance Sensor Basics",
            "Ultrasonic + Servo Radar",
            "Motor Driver with 4 Wheels",
            "2WD Robot Assembly",
            "Chassis Building",
            "Maze Solver Bot",
            "Wall Follower",
            "Edge Avoider",
            "Gesture Controlled Robot (IR Remote)",
            "Wireless Bot with Switches",
            "Speed Controlled Bot",
            "Obstacle + Line Combo Bot",
            "Smart Dustbin with Servo",
            "Fire Fighting Bot",
            "Temperature-Based Fan Bot"
        ];
        const emojis = [
            "ðŸ›¤ï¸", "ðŸ¤–", "ðŸ“", "ðŸ“¡", "ðŸš—", "ðŸ› ï¸", "ðŸ—ï¸", "ðŸŒ€", "ðŸ§±", "âš ï¸", "âœ‹", "ðŸ“¶", "ðŸŽï¸", "ðŸš§", "ðŸ—‘ï¸", "ðŸ”¥", "ðŸŒ¡ï¸"
        ];

        // Per-topic links (edit these individually). Order must match `tasks`.
        const topicLinks = [
            INTRO_URL, // IR Sensor-based Line Follower
            INTRO_URL, // Obstacle Avoidance Bot
            INTRO_URL, // Ultrasonic Distance Sensor Basics
            INTRO_URL, // Ultrasonic + Servo Radar
            INTRO_URL, // Motor Driver with 4 Wheels
            INTRO_URL, // 2WD Robot Assembly
            INTRO_URL, // Chassis Building
            INTRO_URL, // Maze Solver Bot
            INTRO_URL, // Wall Follower
            INTRO_URL, // Edge Avoider
            INTRO_URL, // Gesture Controlled Robot (IR Remote)
            INTRO_URL, // Wireless Bot with Switches
            INTRO_URL, // Speed Controlled Bot
            INTRO_URL, // Obstacle + Line Combo Bot
            INTRO_URL, // Smart Dustbin with Servo
            INTRO_URL, // Fire Fighting Bot
            INTRO_URL  // Temperature-Based Fan Bot
        ];

        function loadCompletions() {
            const completions = JSON.parse(localStorage.getItem('grade6_completions') || '{}');
            return completions;
        }

        function saveCompletions(completions) {
            localStorage.setItem('grade6_completions', JSON.stringify(completions));
        }

        let currentItem = null;
        let currentIndex = null;
        let currentCompletions = null;

        function showVerificationModal(item, index, completions) {
            currentItem = item;
            currentIndex = index;
            currentCompletions = completions;
            document.getElementById('verificationModal').style.display = 'block';
            document.getElementById('verificationCode').value = '';
            document.getElementById('verificationCode').focus();
        }

        function closeModal() {
            document.getElementById('verificationModal').style.display = 'none';
            currentItem = null;
            currentIndex = null;
            currentCompletions = null;
        }

        function verifyCode() {
            const code = document.getElementById('verificationCode').value;
            if (code === '1234') {
                currentItem.classList.add('completed');
                currentCompletions[currentIndex] = true;
                saveCompletions(currentCompletions);
                closeModal();
            } else {
                alert('Incorrect code! Task not marked as completed.');
                document.getElementById('verificationCode').value = '';
                document.getElementById('verificationCode').focus();
            }
        }

        function generateButtons() {
            const grid = document.getElementById('buttonGrid');
            const completions = loadCompletions();
            grid.innerHTML = '';
            tasks.forEach((task, index) => {
                const item = document.createElement('div');
                item.className = 'activity-item';
                if (completions[index]) {
                    item.classList.add('completed');
                }
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = completions[index] || false;
                checkbox.addEventListener('change', () => {
                    if (checkbox.checked) {
                        showVerificationModal(item, index, completions);
                        checkbox.checked = false; // Temporarily uncheck until verified
                    } else {
                        item.classList.remove('completed');
                        delete completions[index];
                        saveCompletions(completions);
                    }
                });

                // Keep same UI but make the text clickable to open per-topic link
                const textSpan = document.createElement('span');
                textSpan.className = 'topic-text';
                textSpan.textContent = `${emojis[index] || ''} ${task}`;
                textSpan.style.cursor = 'pointer';
                textSpan.addEventListener('click', () => {
                    const url = topicLinks[index] || INTRO_URL;
                    window.open(url, '_blank', 'noopener');
                });

                item.appendChild(checkbox);
                item.appendChild(textSpan);
                grid.appendChild(item);
            });
        }
        generateButtons();

        // Load student name and update welcome message
        const studentData = JSON.parse(localStorage.getItem('loggedInStudent') || '{}');
        if (studentData.name) {
            document.querySelector('.welcome').textContent = `Welcome, ${studentData.name}!`;
        }

        // Modal event listeners - executed after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Close modal when clicking outside
            window.onclick = function(event) {
                const modal = document.getElementById('verificationModal');
                if (event.target === modal) {
                    closeModal();
                }
            }

            // Handle Enter key in input
            document.getElementById('verificationCode').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    verifyCode();
                }
            });
        });
    </script>

    <!-- Verification Modal -->
    <div id="verificationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close" onclick="closeModal()">&times;</span>
                Teacher Verification Required
            </div>
            <div class="modal-body">
                <p>Enter the teacher verification code to mark this task as completed:</p>
                <input type="password" id="verificationCode" placeholder="Enter code..." maxlength="4">
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-cancel" onclick="closeModal()">Cancel</button>
                <button class="modal-btn btn-verify" onclick="verifyCode()">Verify</button>
            </div>
        </div>
    </div>

</body>
</html>