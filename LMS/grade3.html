<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 3 LMS</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="grade3">
    <button class="intro-btn" onclick="alert('Welcome to Grade 3 Introduction!')">INTRODUCTION</button>
        <div class="dashboard">
            <h1>ðŸŒ± GRADE 3 Learning Management System</h1>
            <div class="welcome">Welcome to Grade 3</div>
            <div class="curriculum">
                  <div class="button-grid" id="buttonGrid">
                    <!-- Buttons will be generated by JS -->
                </div>
            </div>
        </div>


    <script>
        const INTRO_URL = 'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing';
        const INTRO1_URL = 'https://docs.google.com/presentation/d/1whCZ5nHN0uWpPDPD7DfRAfYLaVF8kWkcQBFrC-bA9TY/edit?usp=sharing';

        const tasks = [
            "Intro to Arduino & Breadboard",
            "Blinking LED",
            "Button-controlled LED",
            "Digital Read/Write",
            "Potentiometer (Analog Input)",
            "LED Brightness with Potentiometer",
            "Buzzer Control",
            "Servo Motor with Knob",
            "DC Motor On/Off",
            "IR Sensor with Buzzer",
            "LDR â€“ Auto Light",
            "DHT11 Display on Serial",
            "LCD Display Basics",
            "LCD + Temperature Display",
            "RGB LED Color Mix",
            "Flame Sensor Alert",
            "Soil Moisture Sensor"
        ];
        const emojis = [
            "ðŸ”Œ", "ðŸ’¡", "ðŸ”˜", "ðŸ“Š", "ðŸŽ›ï¸", "ðŸŒŸ", "ðŸ”Š", "âš™ï¸", "ðŸ”„", "ðŸ“¡", "ðŸŒž", "ðŸŒ¡ï¸", "ðŸ“º", "ðŸ–¥ï¸", "ðŸŽ¨", "ðŸ”¥", "ðŸŒ±"
        ];

        // Per-topic links (edit these individually). Keep order aligned with `tasks`.
        const topicLinks = [
            INTRO_URL, // Intro to Arduino & Breadboard
            INTRO1_URL, // Blinking LED
            INTRO_URL, // Button-controlled LED
            INTRO_URL, // Digital Read/Write
            INTRO_URL, // Potentiometer (Analog Input)
            INTRO_URL, // LED Brightness with Potentiometer
            INTRO_URL, // Buzzer Control
            INTRO_URL, // Servo Motor with Knob
            INTRO_URL, // DC Motor On/Off
            INTRO_URL, // IR Sensor with Buzzer
            INTRO_URL, // LDR â€“ Auto Light
            INTRO_URL, // DHT11 Display on Serial
            INTRO_URL, // LCD Display Basics
            INTRO_URL, // LCD + Temperature Display
            INTRO_URL, // RGB LED Color Mix
            INTRO_URL, // Flame Sensor Alert
            INTRO_URL  // Soil Moisture Sensor
        ];

        function loadCompletions() {
            return JSON.parse(localStorage.getItem('grade3_completions') || '{}');
        }

        function saveCompletions(completions) {
            localStorage.setItem('grade3_completions', JSON.stringify(completions));
        }

        let currentItem = null;
        let currentIndex = null;
        let currentCompletions = null;

        function showVerificationModal(item, index, completions) {
            currentItem = item;
            currentIndex = index;
            currentCompletions = completions;
            document.getElementById('verificationModal').style.display = 'block';
            document.getElementById('verificationCode').value = '';
            document.getElementById('verificationCode').focus();
        }

        function closeModal() {
            document.getElementById('verificationModal').style.display = 'none';
            currentItem = null;
            currentIndex = null;
            currentCompletions = null;
        }

        function verifyCode() {
            const code = document.getElementById('verificationCode').value;
            if (code === '1234') {
                currentItem.classList.add('completed');
                currentCompletions[currentIndex] = true;
                saveCompletions(currentCompletions);
                closeModal();
            } else {
                alert('Incorrect code! Task not marked as completed.');
                document.getElementById('verificationCode').value = '';
                document.getElementById('verificationCode').focus();
            }
        }

        function generateButtons() {
            const grid = document.getElementById('buttonGrid');
            const completions = loadCompletions();
            grid.innerHTML = '';
            tasks.forEach((task, index) => {
                const item = document.createElement('div');
                item.className = 'activity-item';
                if (completions[index]) item.classList.add('completed');

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = !!completions[index];
                checkbox.addEventListener('change', () => {
                    if (checkbox.checked) {
                        showVerificationModal(item, index, completions);
                        checkbox.checked = false; // hold until verified
                    } else {
                        item.classList.remove('completed');
                        delete completions[index];
                        saveCompletions(completions);
                    }
                });

                // Keep same UI: text next to checkbox but make it clickable to open per-topic link
                const textSpan = document.createElement('span');
                textSpan.className = 'topic-text';
                textSpan.textContent = `${emojis[index] || ''} ${task}`;
                textSpan.style.cursor = 'pointer';
                textSpan.addEventListener('click', () => {
                    const url = topicLinks[index] || INTRO_URL;
                    window.open(url, '_blank', 'noopener');
                });

                item.appendChild(checkbox);
                item.appendChild(textSpan);
                grid.appendChild(item);
            });
        }

        generateButtons();

        // Load student name and update welcome message
        const studentData = JSON.parse(localStorage.getItem('loggedInStudent') || '{}');
        if (studentData.name) {
            document.querySelector('.welcome').textContent = `Welcome, ${studentData.name}!`;
        }

        // Modal handlers
        document.addEventListener('DOMContentLoaded', function() {
            window.onclick = function(event) {
                const modal = document.getElementById('verificationModal');
                if (event.target === modal) closeModal();
            };
            document.getElementById('verificationCode').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') verifyCode();
            });
        });
    </script>

    <!-- Verification Modal -->
    <div id="verificationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close" onclick="closeModal()">&times;</span>
                Teacher Verification Required
            </div>
            <div class="modal-body">
                <p>Enter the teacher verification code to mark this task as completed:</p>
                <input type="password" id="verificationCode" placeholder="Enter code..." maxlength="4">
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-cancel" onclick="closeModal()">Cancel</button>
                <button class="modal-btn btn-verify" onclick="verifyCode()">Verify</button>
            </div>
        </div>
    </div>

</body>
</html>