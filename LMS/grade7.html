<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 7 LMS</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="grade7">
    <button id="openIntro" class="intro-btn">INTRODUCTION</button>
         <div class="dashboard">
            <h1>ðŸŒ´ GRADE 7 Learning Management System</h1>
            <div class="welcome">Welcome to Grade 7</div>
            <div class="curriculum">
                      <div class="button-grid" id="buttonGrid">
                    <!-- Buttons will be generated by JS -->
                </div>
            </div>
        </div>
    </div>


    <script>
        const INTRO_URL = 'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing';
        document.getElementById('openIntro')?.addEventListener('click', () => {
            window.open(INTRO_URL, '_blank', 'noopener');
        });

        const tasks = [
            "Flood Detector Bot",
            "Bluetooth Controlled Car",
            "Android App + Bot",
            "IR + Bluetooth Control Switch",
            "Night Vision Bot (IR + Buzzer)",
            "Smart Door Opener",
            "Smart Stick for Blind",
            "Soil Moisture Irrigation Bot",
            "Automatic Plant Watering Bot",
            "DHT11 + Servo Auto Window",
            "Automatic Sanitizer Dispenser",
            "Parking Assistant using Ultrasonic",
            "Distance Indicator using LCD",
            "LCD on Moving Bot",
            "IR Sensor Controlled Maze Bot",
            "Controlled Rotation Bot",
            "Fire Alarm Robot"
        ];
        const emojis = [
            "ðŸŒŠ", "ðŸ“±", "ðŸ¤–", "ðŸ”€", "ðŸŒ™", "ðŸšª", "ðŸ¦¯", "ðŸ’§", "ðŸŒ±", "ðŸªŸ", "ðŸ§´", "ðŸ…¿ï¸", "ðŸ“", "ðŸ“±", "ðŸŒ€", "ðŸ”„", "ðŸš¨"
        ];

        // Per-topic links (edit these individually). Order must match `tasks`.
        const topicLinks = [
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Flood Detector Bot
            'https://docs.google.com/presentation/d/1whCZ5nHN0uWpPDPD7DfRAfYLaVF8kWkcQBFrC-bA9TY/edit?usp=sharing', // Bluetooth Controlled Car
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Android App + Bot
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // IR + Bluetooth Control Switch
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Night Vision Bot (IR + Buzzer)
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Smart Door Opener
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Smart Stick for Blind
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Soil Moisture Irrigation Bot
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Automatic Plant Watering Bot
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // DHT11 + Servo Auto Window
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Automatic Sanitizer Dispenser
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Parking Assistant using Ultrasonic
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Distance Indicator using LCD
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // LCD on Moving Bot
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // IR Sensor Controlled Maze Bot
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing', // Controlled Rotation Bot
            'https://docs.google.com/presentation/d/1oY8NlJvAZHv6vll_11ewY-_p3b0sIw4BwhkkaSCyWd8/edit?usp=sharing'  // Fire Alarm Robot
        ];

        // Updated generateButtons â€” keeps UI same but makes topic text open its link
        function generateButtons() {
            const grid = document.getElementById('buttonGrid');
            const completions = loadCompletions();
            grid.innerHTML = '';
            tasks.forEach((task, index) => {
                const item = document.createElement('div');
                item.className = 'activity-item';
                if (completions[index]) item.classList.add('completed');

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = completions[index] || false;
                checkbox.addEventListener('change', () => {
                    if (checkbox.checked) {
                        showVerificationModal(item, index, completions);
                        checkbox.checked = false; // hold until verified
                    } else {
                        item.classList.remove('completed');
                        delete completions[index];
                        saveCompletions(completions);
                    }
                });

                const textSpan = document.createElement('span');
                textSpan.className = 'topic-text';
                textSpan.textContent = `${emojis[index] || ''} ${task}`;
                textSpan.style.cursor = 'pointer';
                textSpan.addEventListener('click', () => {
                    const url = topicLinks[index] || topicLinks[0];
                    window.open(url, '_blank', 'noopener');
                });

                item.appendChild(checkbox);
                item.appendChild(textSpan);
                grid.appendChild(item);
            });
        }
        generateButtons();

        function loadCompletions() {
            const completions = JSON.parse(localStorage.getItem('grade7_completions') || '{}');
            return completions;
        }

        function saveCompletions(completions) {
            localStorage.setItem('grade7_completions', JSON.stringify(completions));
        }

        let currentItem = null;
        let currentIndex = null;
        let currentCompletions = null;

        function showVerificationModal(item, index, completions) {
            currentItem = item;
            currentIndex = index;
            currentCompletions = completions;
            document.getElementById('verificationModal').style.display = 'block';
            document.getElementById('verificationCode').value = '';
            document.getElementById('verificationCode').focus();
        }

        function closeModal() {
            document.getElementById('verificationModal').style.display = 'none';
            currentItem = null;
            currentIndex = null;
            currentCompletions = null;
        }

        function verifyCode() {
            const code = document.getElementById('verificationCode').value;
            if (code === '1234') {
                currentItem.classList.add('completed');
                currentCompletions[currentIndex] = true;
                saveCompletions(currentCompletions);
                closeModal();
            } else {
                alert('Incorrect code! Task not marked as completed.');
                document.getElementById('verificationCode').value = '';
                document.getElementById('verificationCode').focus();
            }
        }

        // Load student name and update welcome message
        const studentData = JSON.parse(localStorage.getItem('loggedInStudent') || '{}');
        if (studentData.name) {
            document.querySelector('.welcome').textContent = `Welcome, ${studentData.name}!`;
        }

        // Modal event listeners - executed after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Close modal when clicking outside
            window.onclick = function(event) {
                const modal = document.getElementById('verificationModal');
                if (event.target === modal) {
                    closeModal();
                }
            }

            // Handle Enter key in input
            document.getElementById('verificationCode').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    verifyCode();
                }
            });
        });
    </script>

    <!-- Verification Modal -->
    <div id="verificationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close" onclick="closeModal()">&times;</span>
                Teacher Verification Required
            </div>
            <div class="modal-body">
                <p>Enter the teacher verification code to mark this task as completed:</p>
                <input type="password" id="verificationCode" placeholder="Enter code..." maxlength="4">
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-cancel" onclick="closeModal()">Cancel</button>
                <button class="modal-btn btn-verify" onclick="verifyCode()">Verify</button>
            </div>
        </div>
    </div>

</body>
</html>